---
phase: 11-release-automation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .github/workflows/ci.yml
  - .github/workflows/ci-patched-qt.yml
autonomous: true

must_haves:
  truths:
    - "ci.yml can be called by another workflow via workflow_call"
    - "ci-patched-qt.yml can be called by another workflow via workflow_call"
    - "Both workflows still trigger normally on push/PR as before"
    - "Called workflows produce the same artifacts with the same names"
  artifacts:
    - path: ".github/workflows/ci.yml"
      provides: "Standard matrix CI with workflow_call trigger"
      contains: "workflow_call"
    - path: ".github/workflows/ci-patched-qt.yml"
      provides: "Patched Qt CI with workflow_call trigger"
      contains: "workflow_call"
  key_links:
    - from: ".github/workflows/ci.yml"
      to: "release workflow (plan 02)"
      via: "workflow_call trigger"
      pattern: "workflow_call"
    - from: ".github/workflows/ci-patched-qt.yml"
      to: "release workflow (plan 02)"
      via: "workflow_call trigger"
      pattern: "workflow_call"
---

<objective>
Add `workflow_call` triggers to both existing CI workflows so they can be invoked as reusable workflows by the release workflow.

Purpose: The release workflow (plan 02) needs to call both ci.yml and ci-patched-qt.yml to produce all 10 artifacts. Adding workflow_call avoids duplicating build logic.
Output: Both CI workflows gain an additional trigger without changing any existing behavior.
</objective>

<execution_context>
@C:\Users\stjohnson\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\stjohnson\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.github/workflows/ci.yml
@.github/workflows/ci-patched-qt.yml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add workflow_call trigger to ci.yml</name>
  <files>.github/workflows/ci.yml</files>
  <action>
Add `workflow_call:` to the `on:` block in ci.yml, alongside the existing push/pull_request/workflow_dispatch triggers.

The workflow_call trigger needs no inputs or secrets since the workflow is self-contained (uses public actions, no secrets needed for building).

The `on:` block should become:
```yaml
on:
  push:
    branches: [main]
    paths: [...]
  pull_request:
    branches: [main]
    paths: [...]
  workflow_dispatch:
  workflow_call:
```

Do NOT change anything else in the file. No job changes, no matrix changes, no step changes. Only add the one trigger line.

IMPORTANT: `workflow_call` must be at the same indentation level as the other triggers in the `on:` block.
  </action>
  <verify>Run `python -c "import yaml; yaml.safe_load(open('.github/workflows/ci.yml'))"` (or equivalent) to validate YAML syntax. Visually confirm the on: block has all 4 triggers.</verify>
  <done>ci.yml has workflow_call trigger alongside existing triggers, YAML is valid, no other changes.</done>
</task>

<task type="auto">
  <name>Task 2: Add workflow_call trigger to ci-patched-qt.yml</name>
  <files>.github/workflows/ci-patched-qt.yml</files>
  <action>
Add `workflow_call:` to the `on:` block in ci-patched-qt.yml, alongside the existing push/workflow_dispatch triggers.

The `on:` block should become:
```yaml
on:
  push:
    branches: [main]
    paths: [...]
  workflow_dispatch:
  workflow_call:
```

Do NOT change anything else in the file. Only add the one trigger line.

IMPORTANT: `workflow_call` must be at the same indentation level as the other triggers in the `on:` block.
  </action>
  <verify>Run YAML validation on the file. Visually confirm the on: block has all 3 triggers.</verify>
  <done>ci-patched-qt.yml has workflow_call trigger alongside existing triggers, YAML is valid, no other changes.</done>
</task>

</tasks>

<verification>
1. Both workflow files are valid YAML
2. `grep -c "workflow_call" .github/workflows/ci.yml` returns 1
3. `grep -c "workflow_call" .github/workflows/ci-patched-qt.yml` returns 1
4. No other lines changed (git diff shows only additions of workflow_call lines)
</verification>

<success_criteria>
Both CI workflows accept workflow_call as a trigger while preserving all existing trigger behavior unchanged.
</success_criteria>

<output>
After completion, create `.planning/phases/11-release-automation/11-01-SUMMARY.md`
</output>
